datasource db {
  provider = "sqlite"
}

generator kysely {
  provider = "prisma-kysely"
  output   = "../../src/database"
}

model Source {
  id          Int      @id @default(autoincrement())
  name        String
  type        String
  description String
  enabled     Boolean
  config      Json
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  workspace   Workspace @relation(fields: [workspaceId], references: [id])
  workspaceId Int

  records Record[]

  @@map("source")
}

model Report {
  id        Int      @id @default(autoincrement())
  name      String
  type      String
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  workspace   Workspace @relation(fields: [workspaceId], references: [id])
  workspaceId Int

  @@map("report")
}

model Record {
  id      Int    @id @default(autoincrement())
  summary String
  data    Json

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  source   Source @relation(fields: [sourceId], references: [id])
  sourceId Int

  workspace   Workspace @relation(fields: [workspaceId], references: [id])
  workspaceId Int

  @@map("record")
}

model Workspace {
  id       Int      @id @default(autoincrement())

  workflow String  @unique
  name     String

  reports Report[]
  records Record[]
  sources Source[]

  @@map("workspace")
}
